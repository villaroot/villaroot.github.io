<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <link rel="icon" href="../images/favicon.png">
  <title>Bash: Using For-Loop One-Liners for Admin Tasks</title>
  <meta name="description" content="Using for-loops one-liners is a great way to speed up manual tasks. One of the most common commands that I use when on a Linux machine. I’ll give a brief explanation on what a for-loop is, then show an
  example how I use it on a daily basis.">
  <meta name="keywords" content="VillaRoot, Villa root, Linux, Red Hat, Centos, Bash, for loop, ad hoc, one liner, Admin, Server">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- google font -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Lato&family=Playfair+Display:wght@400;500;700;800;900&display=swap" rel="stylesheet">

  <!-- CSS stylesheet -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../css/article-styles.css">

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</head>

<body>

  <section id="top">
    <div class="container-fluid">

      <!-- Navbar -->
      <nav class="navbar navbar-expand-md">
        <a class="navbar-brand" href="../index.html">Villa~Root</a>
        <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#navbarToggler">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarToggler">
          <ul class="navbar-nav ml-auto">
            <li class="nav-items">
              <a class="nav-link" href="../windows.html">Windows</a>
            </li>
            <li class="nav-items">
              <a class="nav-link" href="../linux.html">Linux</a>
            </li>
            <li class="nav-items">
              <a class="nav-link" href="../cybersecurity.html">CyberSecurity</a>
            </li>
            <li class="nav-items">
              <a class="nav-link" href="../aboutme.html">About Me</a>
            </li>
          </ul>
        </div>

      </nav>
    </div>
  </section>

  <section id="main">

    <!-- jumbotron -->
    <div class="jumbotron jumbotron-fluid ">
      <div class="d-flex flex-wrap justify-content-center title-container">
        <div class=" image-container ">
          <img class="jumbo-image" src="../images/Main-Linux.png" alt="ImageForTitle">
        </div>
        <div class="title-text ">
          <h1 class="jumbo-header">Bash: Using For-Loop One-Liners for Admin Tasks</h1>
          <h6 class="inner-date">Date: Febuary 18, 2021</h6>
        </div>

      </div>
    </div>


    <!-- body content -->
    <div class="all-body">
      <div class="outer-container shadow-lg p-3 mb-5 rounded">

        <h4 >Summary:</h4>
        <p>
          Using for-loop one-liners is a great way to speed up manual tasks.
          It's one of the most common commands that I use when on a Linux machine.
          In this article, I'll explain what a for-loop is, and how it can be modified to be
          a one-liner. Then provide two examples of how an Admin would use this.
        </p>

        <h4>Details:</h4>
        <p>
          A for-loop is a statement that allows you to perform a set of commands, 'x' amount of times.
          Where 'x' is a value you can set. Below is the syntax for a
          basic for-loop you might see in a bash script. Where each set of
          brackets [] is customizable by the programmer.
        </p>
        <pre><code>
  for [element] in [given list]
  do
    [Commands]
  done
        </code></pre>
    <p>
      The example above is essentially saying for every ‘element’ in the ‘given list’
      perform or ‘do’ the following actions ‘commands’. The loops terminates with the 'done'
      command. Now we can modify this to perform a typical task that
      Linux admins use. The example I am going to give is outputting the last line
      in multiple files with a for loop. I have a fresh Centos7 vm setup, so I
      don’t have much ‘real world’ logs to give an example. Therfore, I’m going to use two
      logs in /var/log that come with any Centos7 machine which is ‘messages’ and
      ‘secure’, and output the last line in each file. To put in the same format as the
      first example, it will look as follows:
    </p>
    <pre><code>
  for i in messages secure
  do
    echo $i
    cat $i | tail -1
  done
    </code></pre>
    <p>
      We will use 'i' as the element to hold the current variable. The list we are providing
       is 'messages' and 'secure'. Note: ‘$i’
       holds the value that is currently being passed through the loop.<br><br>
       Now we go into the loop and 'do' the commands 'echo $i' and
       'cat $i | tail -1' for every element. 'Echo $i' outputs the element name which is a
       good tip, so we know which file the output belongs to. 'cat $i' will output the file which will get
       passed through the pipe ‘|’ into the command 'tail -1'. This will grab content starting from
       the end of the file, and ’1’ tells it to grab only 1 line. This set of commands
       will be performed on each element, so first it performs the commands for the ‘messages’
       element, then performs the commands on the ‘secure’ element.
       <br><br> Let’s take this to the next step and make it a one-liner. In linux if you want
       to perform two commands in the same line, just put a semicolon between the commands.
       So if we were to do a ‘pwd’ and ‘date’ command in one line, you would type ‘pwd;date’.
       With that, we can combine the for-loop into one line, so the syntax would look as follows:
    </p>
    <pre><code>
  for [element] in [given list];do [Commands];done
    </code></pre>
    <p>
      In a way, the for-loop is divided into three parts: ‘for’, ‘do’, and ‘done'.
      Where ‘for’ sets up the loop with which variables to use, and the element's name.
      ‘Do’ performs the commands to each element, and ‘done’ ends the loop.
      Between those three parts we put a semicolon. For the example of outputting the tail
      of messages and secure we will need to add another semicolon inside the do part
      because we are performing two commands ‘echo $i’ and ‘cat $i | tail -1’.
      Just like ‘pwd;date’, we will combine it to ‘echo $i; cat $i | tail -1’. The end result is below:
    </p>
    <pre><code>
  for i in messages secure;do echo $i; cat $i | tail -1;done
    </code></pre>
    <p>
      Here is a snapshot of it ran on a Centos7 VM:
    </p>
    <img class ="article-image"
      src="../images/Linux-Images/forloop-1.png" alt="ftp-image"><br><br>

      <p>
        Building on this, you can even do a for-loop when you want to perform a quick action
        that requires you to ssh to different servers. Let's say we want to perform a checksum on a fiele
        located on two different servers. We would need to ssh to 'dataserver1' and 'dataserver2' and
        perform the checksum 'cksum' of the file located at /var/log/test.log. It would look as follows:
      </p>
      <pre><code>
  for i in 1 2;do echo $i; ssh -q dataserver$i "cksum /var/log/test.log";done
      </code></pre>
      <p>
        If you want to do more than two commands in the 'do' block, just add another semicolon then
        put the other command.
        <br /><br />Thanks for reading about Bash for-loops from a Linx Admin's point of view!
      </p>


      </div>
    </div>



  </section>
  <!-- footer -->
  <footer class="foot" id="footer">
    <div class="footer-text">
      <p>© Copyright 2022 VillaRoot</p>
    </div>
  </footer>
</body>

</html>
